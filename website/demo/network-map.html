<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Network Map — Software of You</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://d3js.org/d3.v7.min.js"></script>
    <script src="https://unpkg.com/lucide@latest/dist/umd/lucide.min.js"></script>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
    <script>
        tailwind.config = {
            theme: {
                extend: {
                    fontFamily: { sans: ['Inter', 'system-ui', 'sans-serif'] }
                }
            }
        }
    </script>
    <style>
        .nav-item {
            display: flex; align-items: center; gap: 0.375rem; padding: 0.375rem 0.75rem;
            border-radius: 0.5rem; font-size: 0.8125rem; color: #71717a; white-space: nowrap;
            transition: all 0.15s; text-decoration: none;
        }
        .nav-item:hover { background: #f4f4f5; color: #18181b; }
        .nav-item.active { background: #f4f4f5; color: #18181b; font-weight: 600; }
        .nav-badge {
            font-size: 0.6875rem; background: #e4e4e7; color: #52525b;
            padding: 0.0625rem 0.375rem; border-radius: 9999px; font-weight: 500;
        }
        .nav-item.active .nav-badge, .nav-dropdown-item.active .nav-badge { background: #3b82f6; color: white; }
        .nav-group { position: relative; }
        .nav-group-label {
            display: flex; align-items: center; gap: 0.25rem; padding: 0.375rem 0.75rem;
            border-radius: 0.5rem; font-size: 0.8125rem; color: #71717a; cursor: pointer;
            white-space: nowrap; transition: all 0.15s; user-select: none;
        }
        .nav-group-label:hover, .nav-group.active > .nav-group-label { background: #f4f4f5; color: #18181b; }
        .nav-group.active > .nav-group-label { font-weight: 600; }
        .nav-chevron { transition: transform 0.15s; opacity: 0.5; }
        .nav-group:hover .nav-chevron, .nav-group.open .nav-chevron { opacity: 1; }
        .nav-group.open .nav-chevron { transform: rotate(180deg); }
        .nav-dropdown {
            display: none; position: absolute; top: 100%; left: 0; margin-top: 0.25rem;
            min-width: 10rem; background: white; border: 1px solid #e4e4e7; border-radius: 0.75rem;
            box-shadow: 0 4px 6px -1px rgba(0,0,0,0.1), 0 2px 4px -2px rgba(0,0,0,0.1);
            padding: 0.375rem; z-index: 50;
        }
        .nav-group:hover > .nav-dropdown { display: block; }
        .nav-group.open > .nav-dropdown { display: block; }
        .nav-dropdown-item {
            display: flex; align-items: center; gap: 0.375rem; padding: 0.375rem 0.625rem;
            border-radius: 0.375rem; font-size: 0.8125rem; color: #71717a; white-space: nowrap;
            transition: all 0.15s; text-decoration: none;
        }
        .nav-dropdown-item:hover { background: #f4f4f5; color: #18181b; }
        .nav-dropdown-item.active { background: #eff6ff; color: #1d4ed8; font-weight: 600; }

        #network-svg {
            width: 100%;
            height: 70vh;
            min-height: 480px;
        }
        @keyframes pulse-glow {
            0%, 100% { opacity: 1; }
            50% { opacity: 0.7; }
        }
        .pulse-active {
            animation: pulse-glow 3s ease-in-out infinite;
        }
    </style>
  <!-- Google tag (gtag.js) -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=G-TQFFERGZW1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());
    gtag('config', 'G-TQFFERGZW1');
  </script>
</head>
<body class="bg-zinc-50 text-zinc-900 font-sans antialiased">

    <!-- Nav Bar -->
    <nav class="bg-white border-b border-zinc-200 mb-6">
        <div class="max-w-6xl mx-auto px-4">
            <div class="flex items-center gap-1 py-3">
                <a href="dashboard.html" class="flex items-center gap-1.5 px-3 py-1.5 rounded-lg text-sm font-semibold text-zinc-900 hover:bg-zinc-50 transition-colors shrink-0">
                    <i data-lucide="hexagon" class="w-4 h-4"></i>
                    SoY
                </a>
                <span class="w-px h-5 bg-zinc-200 mx-1"></span>
                <a href="dashboard.html" class="nav-item">
                    <i data-lucide="layout-dashboard" class="w-3.5 h-3.5"></i>
                    Dashboard
                </a>
                <!-- People group -->
                <div class="nav-group active" onclick="this.classList.toggle('open')">
                    <div class="nav-group-label">
                        <span>People</span>
                        <i data-lucide="chevron-down" class="w-3 h-3 nav-chevron"></i>
                    </div>
                    <div class="nav-dropdown">
                        <a href="contacts.html" class="nav-dropdown-item">
                            <i data-lucide="users" class="w-3.5 h-3.5"></i>
                            Contacts
                            <span class="nav-badge">7</span>
                        </a>
                        <a href="network-map.html" class="nav-dropdown-item active">
                            <i data-lucide="share-2" class="w-3.5 h-3.5"></i>
                            Network
                        </a>
                    </div>
                </div>
                <!-- Comms group -->
                <div class="nav-group" onclick="this.classList.toggle('open')">
                    <div class="nav-group-label">
                        <span>Comms</span>
                        <i data-lucide="chevron-down" class="w-3 h-3 nav-chevron"></i>
                    </div>
                    <div class="nav-dropdown">
                        <a href="email-hub.html" class="nav-dropdown-item">
                            <i data-lucide="mail" class="w-3.5 h-3.5"></i>
                            Email
                            <span class="nav-badge">58</span>
                        </a>
                        <a href="week-view.html" class="nav-dropdown-item">
                            <i data-lucide="calendar" class="w-3.5 h-3.5"></i>
                            Calendar
                            <span class="nav-badge">28</span>
                        </a>
                    </div>
                </div>
                <!-- Intelligence group -->
                <div class="nav-group" onclick="this.classList.toggle('open')">
                    <div class="nav-group-label">
                        <span>Intelligence</span>
                        <i data-lucide="chevron-down" class="w-3 h-3 nav-chevron"></i>
                    </div>
                    <div class="nav-dropdown">
                        <a href="conversations.html" class="nav-dropdown-item">
                            <i data-lucide="message-square" class="w-3.5 h-3.5"></i>
                            Conversations
                            <span class="nav-badge">3</span>
                        </a>
                        <a href="decision-journal.html" class="nav-dropdown-item">
                            <i data-lucide="git-branch" class="w-3.5 h-3.5"></i>
                            Decisions
                            <span class="nav-badge">5</span>
                        </a>
                        <a href="journal.html" class="nav-dropdown-item">
                            <i data-lucide="book-open" class="w-3.5 h-3.5"></i>
                            Journal
                            <span class="nav-badge">1</span>
                        </a>
                        <a href="notes.html" class="nav-dropdown-item">
                            <i data-lucide="sticky-note" class="w-3.5 h-3.5"></i>
                            Notes
                        </a>
                    </div>
                </div>
            </div>
            <!-- Breadcrumb -->
            <div class="flex items-center justify-between pb-3 -mt-1">
                <div class="flex items-center gap-1.5 text-sm">
                    <a href="dashboard.html" class="text-zinc-400 hover:text-zinc-600">Dashboard</a>
                    <span class="text-zinc-300">&rsaquo;</span>
                    <span class="text-zinc-700 font-medium">Network</span>
                </div>
            </div>
        </div>
    </nav>

    <div class="max-w-6xl mx-auto px-4 pb-8">

        <!-- Header Card -->
        <div class="bg-white rounded-xl shadow-sm border border-zinc-200 p-6 mb-6">
            <div class="flex items-center justify-between flex-wrap gap-4">
                <div>
                    <div class="flex items-center gap-2">
                        <i data-lucide="share-2" class="w-5 h-5 text-zinc-700"></i>
                        <h1 class="text-2xl font-bold text-zinc-900">Your Network</h1>
                    </div>
                    <p class="text-sm text-zinc-500 mt-1">7 contacts, 10 connections</p>
                </div>
                <div class="flex items-center gap-2 flex-wrap">
                    <label for="filter-company" class="text-xs text-zinc-500">Filter:</label>
                    <select id="filter-company" class="text-xs border border-zinc-200 rounded-lg px-2 py-1.5 bg-white text-zinc-700 focus:outline-none focus:ring-2 focus:ring-blue-500">
                        <option value="all">All Companies</option>
                        <option value="Northgate Development">Northgate Development</option>
                        <option value="Apex Group">Apex Group</option>
                        <option value="Verdant Co">Verdant Co</option>
                    </select>
                    <button id="reset-filter" class="text-xs px-2 py-1.5 rounded-lg border border-zinc-200 text-zinc-500 hover:bg-zinc-50 transition-colors">Show All</button>
                </div>
            </div>
        </div>

        <!-- Network Visualization -->
        <div class="bg-white rounded-xl shadow-sm border border-zinc-200 mb-6 relative overflow-hidden">
            <svg id="network-svg"></svg>

            <!-- Zoom controls -->
            <div class="absolute bottom-4 right-4 flex flex-col gap-1">
                <button id="zoom-in" class="w-8 h-8 bg-white border border-zinc-200 rounded-lg shadow-sm flex items-center justify-center text-zinc-500 hover:bg-zinc-50 hover:text-zinc-700 transition-colors text-lg font-medium">+</button>
                <button id="zoom-out" class="w-8 h-8 bg-white border border-zinc-200 rounded-lg shadow-sm flex items-center justify-center text-zinc-500 hover:bg-zinc-50 hover:text-zinc-700 transition-colors text-lg font-medium">&minus;</button>
                <button id="zoom-reset" class="w-8 h-8 bg-white border border-zinc-200 rounded-lg shadow-sm flex items-center justify-center text-zinc-500 hover:bg-zinc-50 hover:text-zinc-700 transition-colors text-xs font-medium">Fit</button>
            </div>

            <!-- Legend -->
            <div class="absolute bottom-4 left-4 bg-white/90 backdrop-blur-sm border border-zinc-200 rounded-lg p-3 shadow-sm">
                <p class="text-xs font-semibold text-zinc-500 mb-2">Companies</p>
                <div class="space-y-1">
                    <div class="flex items-center gap-2">
                        <span class="w-3 h-3 rounded-full" style="background: #3b82f6;"></span>
                        <span class="text-xs text-zinc-600">Northgate Development</span>
                    </div>
                    <div class="flex items-center gap-2">
                        <span class="w-3 h-3 rounded-full" style="background: #10b981;"></span>
                        <span class="text-xs text-zinc-600">Apex Group</span>
                    </div>
                    <div class="flex items-center gap-2">
                        <span class="w-3 h-3 rounded-full" style="background: #f59e0b;"></span>
                        <span class="text-xs text-zinc-600">Verdant Co</span>
                    </div>
                </div>
                <p class="text-xs font-semibold text-zinc-500 mt-3 mb-1">Node Size</p>
                <p class="text-xs text-zinc-400">Larger = more activity</p>
            </div>
        </div>

        <!-- Stats Bar -->
        <div class="grid grid-cols-2 md:grid-cols-4 gap-4 mb-6">
            <div class="bg-white rounded-xl shadow-sm border border-zinc-200 p-4 text-center">
                <p class="text-2xl font-bold text-zinc-900">7</p>
                <p class="text-xs text-zinc-500 mt-1">Total Contacts</p>
            </div>
            <div class="bg-white rounded-xl shadow-sm border border-zinc-200 p-4 text-center">
                <p class="text-2xl font-bold text-zinc-900">3</p>
                <p class="text-xs text-zinc-500 mt-1">Companies</p>
            </div>
            <div class="bg-white rounded-xl shadow-sm border border-zinc-200 p-4 text-center">
                <p class="text-sm font-bold text-blue-600">Marcus Webb</p>
                <p class="text-xs text-zinc-500 mt-1">Most Activity</p>
            </div>
            <div class="bg-white rounded-xl shadow-sm border border-zinc-200 p-4 text-center">
                <p class="text-sm font-bold text-amber-600">Verdant Co</p>
                <p class="text-xs text-zinc-500 mt-1">Most Connected</p>
            </div>
        </div>

        <!-- Footer -->
        <footer class="mt-8 pt-4 border-t border-zinc-100 text-center">
            <p class="text-xs text-zinc-400">Generated by Software of You &middot; February 20, 2026 at 3:45 PM</p>
        </footer>

    </div>

    <!-- Tooltip -->
    <div id="tooltip" class="fixed bg-white border border-zinc-200 rounded-lg shadow-lg p-3 pointer-events-none z-50 hidden" style="max-width: 260px;">
        <div id="tt-name" class="font-semibold text-zinc-900 text-sm"></div>
        <div id="tt-role" class="text-xs text-zinc-500 mt-0.5"></div>
        <div id="tt-company" class="text-xs text-zinc-500 mt-0.5"></div>
        <div id="tt-meta" class="mt-2 pt-2 border-t border-zinc-100 text-xs text-zinc-400"></div>
    </div>

    <script>
    lucide.createIcons();

    // Graph Data
    var nodes = [
        {
            id: 1, name: "Marcus Webb", company: "Northgate Development", role: "Vice President",
            type: "individual", activityCount: 4, lastActivity: "today",
            entityPage: "contact-daniel-byrne.html", recentlyActive: true,
            relationshipDepth: "professional", trajectory: "strengthening",
            tags: []
        },
        {
            id: 2, name: "James Okafor", company: "Apex Group", role: "Head of Retail & Luxury",
            type: "individual", activityCount: 3, lastActivity: "today",
            entityPage: "contact-charles-bernard.html", recentlyActive: true,
            relationshipDepth: "transactional", trajectory: "strengthening",
            tags: []
        },
        {
            id: 3, name: "Verdant Co", company: "Verdant Co", role: "",
            type: "company", activityCount: 3, lastActivity: "today",
            entityPage: "contact-benjis.html", recentlyActive: true,
            relationshipDepth: null, trajectory: null,
            tags: []
        },
        {
            id: 4, name: "Sofia Reyes", company: "Verdant Co", role: "Owner",
            type: "individual", activityCount: 3, lastActivity: "today",
            entityPage: "contact-jp-moya.html", recentlyActive: true,
            relationshipDepth: "trusted", trajectory: "stable",
            tags: []
        },
        {
            id: 5, name: "Priya Nair", company: "Verdant Co", role: "Operations Lead",
            type: "individual", activityCount: 2, lastActivity: "today",
            entityPage: "contact-emma-cuddy.html", recentlyActive: true,
            relationshipDepth: "collaborative", trajectory: "strengthening",
            tags: []
        },
        {
            id: 6, name: "Zoe Hartley", company: "Verdant Co", role: "Finance & Admin",
            type: "individual", activityCount: 2, lastActivity: "today",
            entityPage: "contact-gigi-presentey.html", recentlyActive: true,
            relationshipDepth: "professional", trajectory: "cooling",
            tags: []
        },
        {
            id: 7, name: "Tariq Hassan", company: "Verdant Co", role: "Operations",
            type: "individual", activityCount: 2, lastActivity: "today",
            entityPage: "contact-nawid-fatahi.html", recentlyActive: true,
            relationshipDepth: "professional", trajectory: "stable",
            tags: []
        }
    ];

    var links = [
        // Explicit: Verdant Co owns Sofia Reyes
        { source: 3, target: 4, type: "owner", strength: 3, label: "owner" },
        // Same company: Verdant Co cluster
        { source: 3, target: 5, type: "company", strength: 1, label: "" },
        { source: 3, target: 6, type: "company", strength: 1, label: "" },
        { source: 3, target: 7, type: "company", strength: 1, label: "" },
        { source: 4, target: 5, type: "company", strength: 1, label: "" },
        { source: 4, target: 6, type: "company", strength: 1, label: "" },
        { source: 4, target: 7, type: "company", strength: 1, label: "" },
        { source: 5, target: 6, type: "company", strength: 1, label: "" },
        { source: 5, target: 7, type: "company", strength: 1, label: "" },
        { source: 6, target: 7, type: "company", strength: 1, label: "" }
    ];

    // Company Colors
    var companyColorMap = {
        "Northgate Development": "#3b82f6",
        "Apex Group": "#10b981",
        "Verdant Co": "#f59e0b"
    };

    // Compute node sizes and opacity
    var maxActivity = Math.max.apply(null, nodes.map(function(n) { return n.activityCount; }));
    if (maxActivity < 1) maxActivity = 1;
    nodes.forEach(function(n) {
        n.size = 8 + (n.activityCount / maxActivity) * 32;
        n.color = companyColorMap[n.company] || "#71717a";
        n.opacity = 1.0;
    });

    // SVG Setup
    var svg = d3.select("#network-svg");
    var svgEl = svg.node();
    var width = svgEl.getBoundingClientRect().width;
    var height = svgEl.getBoundingClientRect().height;
    var g = svg.append("g");

    // Zoom
    var zoomBehavior = d3.zoom()
        .scaleExtent([0.3, 4])
        .on("zoom", function(event) { g.attr("transform", event.transform); });
    svg.call(zoomBehavior);

    // Zoom controls
    document.getElementById("zoom-in").addEventListener("click", function() {
        svg.transition().duration(300).call(zoomBehavior.scaleBy, 1.3);
    });
    document.getElementById("zoom-out").addEventListener("click", function() {
        svg.transition().duration(300).call(zoomBehavior.scaleBy, 0.7);
    });
    document.getElementById("zoom-reset").addEventListener("click", function() {
        svg.transition().duration(500).call(zoomBehavior.transform, d3.zoomIdentity);
    });

    // Double-click to reset
    svg.on("dblclick.zoom", null);
    svg.on("dblclick", function() {
        svg.transition().duration(500).call(zoomBehavior.transform, d3.zoomIdentity);
    });

    // Force Simulation
    var simulation = d3.forceSimulation(nodes)
        .force("link", d3.forceLink(links).id(function(d) { return d.id; }).distance(function(d) { return d.type === "company" ? 60 : 80; }))
        .force("charge", d3.forceManyBody().strength(-300))
        .force("center", d3.forceCenter(width / 2, height / 2))
        .force("collision", d3.forceCollide().radius(function(d) { return d.size + 8; }))
        .force("x", d3.forceX(width / 2).strength(0.05))
        .force("y", d3.forceY(height / 2).strength(0.05));

    // Draw Edges
    var link = g.append("g")
        .attr("class", "links")
        .selectAll("line")
        .data(links)
        .join("line")
        .attr("stroke", function(d) { return d.type === "company" ? "#e4e4e7" : "#d4d4d8"; })
        .attr("stroke-width", function(d) { return d.strength; })
        .attr("stroke-opacity", 0.6);

    // Draw Nodes
    var node = g.append("g")
        .attr("class", "nodes")
        .selectAll("circle")
        .data(nodes)
        .join("circle")
        .attr("r", function(d) { return d.size; })
        .attr("fill", function(d) { return d.color; })
        .attr("stroke", "#fff")
        .attr("stroke-width", 2)
        .attr("opacity", function(d) { return d.opacity; })
        .attr("cursor", "pointer")
        .call(drag(simulation));

    // Draw Labels
    var label = g.append("g")
        .attr("class", "labels")
        .selectAll("text")
        .data(nodes)
        .join("text")
        .text(function(d) { return d.name.split(" ")[0]; })
        .attr("font-size", "11px")
        .attr("font-family", "Inter, sans-serif")
        .attr("fill", "#3f3f46")
        .attr("text-anchor", "middle")
        .attr("dy", function(d) { return d.size + 14; })
        .attr("pointer-events", "none");

    // Tick
    simulation.on("tick", function() {
        link.attr("x1", function(d) { return d.source.x; })
            .attr("y1", function(d) { return d.source.y; })
            .attr("x2", function(d) { return d.target.x; })
            .attr("y2", function(d) { return d.target.y; });
        node.attr("cx", function(d) { return d.x; })
            .attr("cy", function(d) { return d.y; });
        label.attr("x", function(d) { return d.x; })
            .attr("y", function(d) { return d.y; });
    });

    // Drag
    function drag(simulation) {
        return d3.drag()
            .on("start", function(event, d) {
                if (!event.active) simulation.alphaTarget(0.3).restart();
                d.fx = d.x; d.fy = d.y;
            })
            .on("drag", function(event, d) { d.fx = event.x; d.fy = event.y; })
            .on("end", function(event, d) {
                if (!event.active) simulation.alphaTarget(0);
                d.fx = null; d.fy = null;
            });
    }

    // Tooltip
    var tooltip = document.getElementById("tooltip");
    var ttName = document.getElementById("tt-name");
    var ttRole = document.getElementById("tt-role");
    var ttCompany = document.getElementById("tt-company");
    var ttMeta = document.getElementById("tt-meta");

    function showTooltip(event, d) {
        ttName.textContent = d.name;
        ttRole.textContent = d.role || d.type;
        ttCompany.textContent = d.company || "";

        // Build meta content safely using DOM methods
        while (ttMeta.firstChild) ttMeta.removeChild(ttMeta.firstChild);

        var activityLine = document.createElement("div");
        activityLine.textContent = d.activityCount + " activities \u00B7 Last: " + d.lastActivity;
        ttMeta.appendChild(activityLine);

        if (d.relationshipDepth) {
            var depthLine = document.createElement("div");
            depthLine.textContent = "Depth: " + d.relationshipDepth;
            ttMeta.appendChild(depthLine);
        }
        if (d.trajectory) {
            var trajectoryIcon = d.trajectory === "strengthening" ? "\u2197" : d.trajectory === "cooling" ? "\u2198" : "\u2192";
            var trajLine = document.createElement("div");
            trajLine.textContent = "Trajectory: " + trajectoryIcon + " " + d.trajectory;
            ttMeta.appendChild(trajLine);
        }

        tooltip.classList.remove("hidden");
        tooltip.style.left = (event.pageX + 12) + "px";
        tooltip.style.top = (event.pageY - 12) + "px";
    }

    function hideTooltip() {
        tooltip.classList.add("hidden");
    }

    // Hover Effects
    node.on("mouseover", function(event, d) {
        var connected = new Set();
        links.forEach(function(l) {
            var srcId = typeof l.source === "object" ? l.source.id : l.source;
            var tgtId = typeof l.target === "object" ? l.target.id : l.target;
            if (srcId === d.id) connected.add(tgtId);
            if (tgtId === d.id) connected.add(srcId);
        });
        connected.add(d.id);

        node.attr("opacity", function(n) { return connected.has(n.id) ? 1 : 0.15; });
        link.attr("stroke", function(l) {
            var srcId = typeof l.source === "object" ? l.source.id : l.source;
            var tgtId = typeof l.target === "object" ? l.target.id : l.target;
            return (srcId === d.id || tgtId === d.id) ? "#3b82f6" : "#e4e4e7";
        }).attr("stroke-width", function(l) {
            var srcId = typeof l.source === "object" ? l.source.id : l.source;
            var tgtId = typeof l.target === "object" ? l.target.id : l.target;
            return (srcId === d.id || tgtId === d.id) ? l.strength + 2 : l.strength;
        }).attr("stroke-opacity", function(l) {
            var srcId = typeof l.source === "object" ? l.source.id : l.source;
            var tgtId = typeof l.target === "object" ? l.target.id : l.target;
            return (srcId === d.id || tgtId === d.id) ? 1 : 0.2;
        });
        label.attr("opacity", function(n) { return connected.has(n.id) ? 1 : 0.15; });

        d3.select(this)
            .attr("r", d.size * 1.3)
            .style("filter", "drop-shadow(0 0 8px rgba(59, 130, 246, 0.5))");

        showTooltip(event, d);
    })
    .on("mousemove", function(event, d) {
        tooltip.style.left = (event.pageX + 12) + "px";
        tooltip.style.top = (event.pageY - 12) + "px";
    })
    .on("mouseout", function(event, d) {
        node.attr("opacity", function(n) { return n.opacity; });
        link.attr("stroke", function(l) { return l.type === "company" ? "#e4e4e7" : "#d4d4d8"; })
            .attr("stroke-width", function(l) { return l.strength; })
            .attr("stroke-opacity", 0.6);
        label.attr("opacity", 1);
        d3.select(this)
            .attr("r", d.size)
            .style("filter", "none");
        hideTooltip();
    });

    // Click: Open Entity Page
    node.on("click", function(event, d) {
        if (d.entityPage) {
            window.location.href = d.entityPage;
        }
    });

    // Pulse Animation for Recently Active Nodes
    setInterval(function() {
        node.filter(function(d) { return d.recentlyActive; })
            .transition().duration(1500)
            .attr("r", function(d) { return d.size * 1.06; })
            .transition().duration(1500)
            .attr("r", function(d) { return d.size; });
    }, 3000);

    // Filter by Company
    var filterSelect = document.getElementById("filter-company");
    var resetBtn = document.getElementById("reset-filter");

    function applyFilter(company) {
        if (company === "all") {
            node.transition().duration(300).attr("opacity", function(d) { return d.opacity; });
            link.transition().duration(300).attr("stroke-opacity", 0.6);
            label.transition().duration(300).attr("opacity", 1);
        } else {
            node.transition().duration(300).attr("opacity", function(d) { return d.company === company ? d.opacity : 0.1; });
            link.transition().duration(300).attr("stroke-opacity", function(l) {
                var srcCompany = typeof l.source === "object" ? l.source.company : nodes.find(function(n) { return n.id === l.source; }).company;
                var tgtCompany = typeof l.target === "object" ? l.target.company : nodes.find(function(n) { return n.id === l.target; }).company;
                return (srcCompany === company && tgtCompany === company) ? 0.6 : 0.05;
            });
            label.transition().duration(300).attr("opacity", function(d) { return d.company === company ? 1 : 0.1; });
        }
    }

    filterSelect.addEventListener("change", function(e) { applyFilter(e.target.value); });
    resetBtn.addEventListener("click", function() {
        filterSelect.value = "all";
        applyFilter("all");
    });

    // Entry Animation
    simulation.alpha(1).restart();
    </script>
<div id="demo-banner" style="position:fixed;bottom:0;left:0;right:0;z-index:9999;background:#1A4731;color:white;font-family:'DM Mono',monospace;font-size:12px;letter-spacing:0.04em;display:flex;align-items:center;justify-content:center;gap:24px;padding:10px 24px;box-shadow:0 -2px 16px rgba(0,0,0,0.2);">
  <span style="opacity:0.7;">✦ LIVE DEMO — anonymized data</span>
  <span style="opacity:0.4;">|</span>
  <a href="https://softwareof.you/getting-started.html" style="color:#a8e6c0;text-decoration:none;font-weight:500;white-space:nowrap;" target="_top">Get it for yourself →</a>
  <button onclick="document.getElementById('demo-banner').style.display='none'" style="margin-left:8px;background:none;border:none;color:rgba(255,255,255,0.4);cursor:pointer;font-size:16px;line-height:1;padding:0 4px;" title="Dismiss">×</button>
</div>
<div style="height:44px;"></div>
</body>
</html>